{% if customer.metafields.custom.customer_type == "food_vendor" %}
  <div class="yotpo-widget-instance" data-yotpo-instance-id="537747" id="yotpo-widget-1"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="626951" id="yotpo-widget-2"></div>
  
  <div class="yotpo-widget-instance" data-yotpo-instance-id="537749"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="527520"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="527521"></div>
{% elsif customer.metafields.custom.customer_type == "retailer" %}
  <div class="yotpo-widget-instance" data-yotpo-instance-id="537747" id="yotpo-widget-1"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="626951" id="yotpo-widget-2"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="537749"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="527520"></div>

  <div class="yotpo-widget-instance" data-yotpo-instance-id="537723"></div>
{% endif %}|


<script>
const pointsBalanceSpan = document.querySelector('.yotpo-points-balance-number');
const yotpoWidgetDivs = document.querySelectorAll('.yotpo-widget-instance[id^="yotpo-widget-"]'); // Select all divs with IDs starting with "yotpo-widget-"

// Wrap the reloading logic in a function for clarity
function reloadWidgets() {
  yotpoWidgetDivs.forEach(function(div) {
    div.contentWindow.location.reload(true); // Reload each widget's iframe
  });
}

// Listen for DOMSubtreeModified events (for older browsers)
pointsBalanceSpan.addEventListener('DOMSubtreeModified', reloadWidgets);

// Listen for MutationObserver events (for modern browsers)
const observer = new MutationObserver(reloadWidgets);
observer.observe(pointsBalanceSpan, { childList: true, subtree: true });

</script>

